航天金税接口系统（航天金税接口软件）
防伪税控开票接口系统，技术一流，偶也有的，去我的博客看看，http://suntax.blog.com.cn，演示版。 这个时代就是强者生存的时代。 当航天信息防伪税控开票软件6.10版推出的时候，很多的防伪开票接口软件公司没有料到，这个版本会使他们经营多年的防伪开票接口软件（以下简称开票接口 软件）市场受到强大的冲击，由于在新版6.10中，航天信息对销项发票字段采用了新的加密算法，致使那些基于5.02、5.03版的防伪开票接口软件，销 项发票数据不能导出成明文而依然是乱码，乱码成了众多防伪开票接口软件公司头疼之事，各家防伪开票软件公司开始网络编程高手，想尽一切办法寻找销项发票加 密字段转换成明文的方法，于是防伪税控开票接口软件的战国时代来临，而2007年将是防伪税控开票接口软件洗牌之年，何去何从，我们将拭目以待。 笔者接触防伪开票接口软件时间不长也不短，正当笔者将防伪税控开票软件5.03版的销项发票加密字段解密还原成明文而雀跃欢呼的时候，航天信息开始推广 6.10版防伪开票软件，而在新版6.10下，笔者再次尝试研究其加密方式以及还原之法，虽经数月探索依然无果。截至2007年2月1日，笔者在 google中搜遍各大软件网站及防伪开票接口软件公司网站，竟然没有发现有在脱离金税卡的情况下能将防伪税控开票系统中销项发票加密字段还原成明文的软 件（也许有，只是笔者没有发现）。一声长叹，航天信息你这次将销项发票字段加密算法烧进金税卡，着实终结了多少开票接口软件！难道航天信息的这一烧，真的 将防伪税控接口软件公司的财路给烧断了么？不，有道是：魔高一尺，道高一丈。既然2007年是防伪开票接口软件洗牌之年，那么必定是强者生存，而弱者淘 汰。纵观当前的防伪开票接口软件不外乎以下几种： 1． 航天信息公司的防伪开票接口软件： （以下内容摘自航天信息公司网站《防伪开票接口软件》一文） l 防伪开票文本接口软件： 软件通过指定格式的文本文件实现与企业销售管理系统的数据交换。它可以将销售数据批量生成税控发票并进行打印，又可将所生成的发票数据批量传递给销售管理 系统。这就为业务量大但实时性要求不高的企业提供了适宜的解决方案。 l 防伪开票组件接口软件 对于自主或委托开发管理信息系统的企业，我们将防伪税控开票功能以组件形式嵌入到企业销售管理软件内，提供标准开票界面和后台命令两种接口方式，实现企业 日常开具、打印及作废税控发票的功能。这就为需要实时打印发票或有专门开票要求的企业提供了适宜的解决方案。 l 纳税申报组件接口软件 现今，增值税一般纳税人正全面使用防伪税控开票系统，增值税专用发票数据是企业的基本经营数据，这些数据也是纳税申报软件和其它企业信息系统的重要基础数 据，从开票软件中提取发票数据是企业信息一体化的迫切要求。为此，我公司开发了纳税申报组件接口软件，通过ActiveX组件接口实现提取防伪税控开票数 据的功能。 1． 其它开票接口公司的防伪开票接口软件： l 防伪开票接口软件拷屏版： 为什么叫拷屏版，因为在航天信息防伪开票软件中，在销项发票查询界面中，发票的加密字段都被还原成明文而显示在操作者面前，拷屏版的方法就是调用 window api函数，采用鼠标钩子原理，实现将屏幕查询界面中显示的销项发票明文数据 “拷贝”出来，从而实现了将销项发票加密字段还原成明文，而这一方式只适用于将销项发票导出，而不适用于将待开的发票数据导入，因为将待开发票数据写入屏 幕，俗称“写屏”，需要比“拷屏”技术要求更高，而且对于鼠标操作过程中出现的状态更难控制，反正笔者只是听说过这类“写屏”软件，而没有见过试过。笔者 在网上搜索到一家做纳税申报软件公司的“拷屏”版开票接口软件，软件虽然可以将发票数据“拷贝”出来，但有时还是经常提示找不到销项发票查询窗口，看来软 件做的还是有些问题。 l 防伪开票接口软件金税卡版： 既然我们知道航天信息是将销项发票加密字段的加密算法烧在了金税卡里，那么能否将加密后字段密文，扔进金税卡里等金税卡解密还原成明文了，我们再获取，这 样不就可以实现了销项发票数据加密字段还原成明文。思路正确，而技术实现也不难，难的是这样的软件需要考虑以下问题：金税卡分ISA卡和PCI卡，操作系 统分win98,win2000,winxp,win2003，据笔者测试，新版6.10不支持ISA卡在win2000,winxp,win2003下 使用,只支持ISA卡在win98下使用，而PCI卡在win98,win2000,winxp,win2003都支持，但由于操作系统不同，读取卡的端 口的方式不一样，故而要求测试环境齐全，而我们知道防伪税控开票系统是税务局专控的系统，各企业单位一般是不允许乱动的，这就造成了有实现的方法，而没有 测试的环境，除非你是航天信息防伪税控服务单位，能有这个便利条件。受条件限制，笔者测试过win98下ISA卡的发票加密字段的解密，对于其它情况，由 于没有环境，无法测试。但笔者依然在网上寻到这样的一款软件，不知道试用后结果如何（因为笔者没有防伪税控真实环境，有使用过其软件的可以告诉笔者）？而 根据这款软件的帮助文件提示：“该工具能够在不启动防伪开票软件的情况下，对企业已经开具的发票及明细信息进行查询和导出。并且对“防伪开票v6.10” 中加密 的“购方名称”、“购方税号”、“购方地址电话”、“购方银行帐号”字段以明文的方式显示。”“只要正确安装了“防伪开票v6.10”的软硬件即可正常使 用该工具。”很显然这是一款金税卡版的防伪开票接口软件，这样的软件只能实现将销项发票数据导出，而不能导入。 l 防伪开票接口软件复制版： 不知道为什么？航天信息在防伪开票系统6.10新版中，只顾忙着将发票字段加密算法烧进金税卡中，还是对这个发票“复制”功能存在意义认识不够，反正在新 版6.10中依然保留了在填开发票的窗口中复制发票功能，也正是这一功能的保留，使许多公司防伪开票接口软件复制版在6.10 版下生存下来，躲过这一劫。但无论如何，这一次的大难不死，谁又知道下一次将会如何？当有一天航天信息意识到这个“复制”功能的重要性的时候，如果加以限 制，那将使多少家复制版接口软件被终结。所谓复制版，就是将要开票的发票数据写入到航天的发票库中，这时候使用复制功能，就可以显示出来了，然后将这张假 的发票通过复制方式复制成真票，打印出来，而这时发票库中还存在一张假票，假票怎么处理，当然是开完真票以后，将假票删除了。操作起来麻烦点，但这种办法 可以说是简单可行，航天信息的任意一个版本都通用，笔者也曾测试过这样的复制是否可以？从测试情况看，这样的复制版完全可以在5.02、5.03和 6.10新版下使用，而且测试效果很好。笔者在网上也寻到这样的一款软件。从版本看只支持5.02版，而在新版6.10就没有再更新，可见这款软件不能导 出加密的发票数据。如此复制版的软件在新版6.10下只能将发票数据导入，而不能导出。似乎有点欠缺点什么。 l 防伪开票接口软件函数寻址版：简称函址版 叫这个名字完全是因为广州有家接口公司提出来的，而正是这个名称的诞生，标志着防伪开票接口软件的新时代的到来，我想2007年将是这个版本被广大用户认 可的一年，这个版本完全将企业的防伪开票机与企业的管理软件财务软件结合成一个整体，不用考虑金税卡的种类，开票软件的版本5.03还是6.10统吃。可 以说是防伪开票接口软件的一个里程碑，无论我说什么，你们都没有意识到这个软件的重要意义，因为他已经把自己融进航天防伪开票系统中，完全使用航天开票系 统进行开票，这个接口软件不对航天信息开票系统进行写入操作，而读操作也都是由航天信息开票软件自己完成后转交到接口软件，真正意义上的安全绿色软件。据 笔者google中搜索，至今真正实现这一方法的接口公司只有2家半，都是广州的公司，半家的说法是因为有家公司实现了这个方式，但其在发票数据导出的时 候，不知道为什么，居然把明文发票数据回写进发票数据库复盖加密的发票数据，这可是税务局坚决不允许的，但这家公司却这样做了。所以，说是半家。未来在防 伪开票接口市场上最具竞争力的就是函址版。 2． 防伪开票接口软件比较： 从长远的发展方向来看拷屏版、金卡版由于只能导出发票数据，而不能导入，将在应用上受到限制，特别是金税卡版由于接口软件直接读写金税卡，使得防伪税控开 票系统的安全性受到威胁，故而企业将会慎重考虑选择。复制版也只能导入而不能导出，在当前接口软件市场上仍然占有一席之地，但对于要求将销项发票数据导出 的企业就无能为力了。大势所趋，函数寻址版由于既可以导出又可以导入，而且不论航天信息5,.03版还是6.10版，都可以使用，不受金税卡种类限制，是 真正意义上的防伪税控开票接口软件。 笔者写这篇文章不能不提航天信息的开票接口软件，故此进行比较一下：（函数寻址版） 航天文本接口：是通过交换文本数据来达到自动开票的目的，具体的说就是要求企业的ERP和财务软件可以生成一个发票数据的文本文件，文本的格式是航天信息 已经定义好的，现在很多财务软件公司都提供了这个文本发票数据输出功能，如：用友、金蝶和金算盘。然后企业通过文本接口的读取文本文件的发票数据，生成发 票。这样生成发票只能批量生成，一旦生成的发票出现错误，那是不能再修改，而只能作废重开，因此，航天文本接口的作废率很高，也不能实现发票的合并和拆 分。功能单一，而就是这样的一个简单的文本接口，航天信息的公开报价是6800。（具网上某论坛的帖子中这样说的，笔者没有实际咨询过。） 航天的组件接口：是通过调用航天所提供的DLL中的函数，直接开票和打印，当然这样开发出来的接口软件使用肯定是没有什么问题，唯一的问题是由于是航天信 息一家才拥有的技术，不可能大面积推广，据说只有航天信息北京总部才能做这样的开发，而且其价格不菲，9800元（具网上某论坛的帖子中这样说的，笔者没 有实际咨询过）是基础价格，如果在这个基础上进行二次开发那价格就不知道是什么了？ 函数寻址版开票接口是独立于航天的文本接口和航天的组件接口，独自开辟另一种新的专有的完全和开票系统集成的解决方式。是集成在开票窗口中的功能，能够很 好的保持操作员的操作习惯，只增多一个导入按钮和一导出按钮，既可以将文本文件导入也可以依据企业自己定义的excel文件导导入，可以实现发票的合并和 拆分，能够和现今财务软件结合如用友、金蝶和金算盘。真正意义上的将企业的财务软件ERP和防伪税控开票系统合成一体。 3． 总结 笔者只是将网上防伪开票接口软件进行一个分析，文中难免会遗漏一些公司其他方式的版本，但总的来说，防伪开票接口软件大概就是这么几类，而在这几类版本的 开票接口软件中，最具竞争能力的就是函数寻址版。 如果你公司有这方面的开票接口需求或咨询，请与本人联系。 联系方式：QQ:：5733358 e-mail：suntaxcn@163.com 网站博客留言：suntax.blog.com.cn